<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Neutron Activation and Scattering Calculator</title>
    <link rel="shortcut icon" href="favicon.ico">

    <style type="text/css">
        @media print
        {
            body { font-size: 10pt !important; }
            table, caption, th, td {
                font-size: 10pt !important;
                /* border: 0.1pt solid lightgray !important; */
                border: none !important;
            }
            .no-print { display: none !important; height: 0; }
            .no-print *{ display: none !important; height: 0; }
            .print-only { display: block !important; }
            .print-only *{ display: block !important; }
        }
        .print-only { display: none; }
        .print-only *{ display: none; }

        p { margin-bottom: 0; }
        .footer p { margin-top: 0; }
        /* body { font-size: 0.9em; } */
        .disabled { opacity: 0.3; }
        label { font-weight: inherit; }
        .controls input { width: 100%; }
        table { margin: 0; padding: 0; border-spacing: 0; border-color: lightgray; }
        caption, td, th { padding: 0 0.5em 0 0.5em; }
        th { vertical-align: baseline; }
        tbody tr:nth-child(2n) th, tbody tr.even th,
        tbody tr:nth-child(2n) td, tbody tr.even td,
        ul li:nth-child(2n), ol li:nth-child(2n) { background: inherit; /* background: none repeat scroll 0 0 #F3F3F9; */ }
        table.tablesorter thead tr .headerSortable {
            background-image: url(resonance-theme/bg.gif);
            background-repeat: no-repeat;
            background-position: center right;
            padding-right: 2em; /* space for sort arrows */
        }
        table.tablesorter thead tr .headerSortUp {
            background-image: url(resonance-theme/asc.gif);
        }
        table.tablesorter thead tr .headerSortDown {
            background-image: url(resonance-theme/desc.gif);
        }

        /* output markup */
        .error { color: red; }
        p.disclaimer { color: darkred; font-size:1.2em; }

        #id_chemical_formula { width: 30em; }

        div.cutoff { display: block; }
        div.nocutoff { display: none; }
        button.activity_button { float: right; }


        /* frame layout */
        #activation-frame { position:absolute; width:30em; }
        #help-frame {
            position:absolute; left:31em;
            margin-right:0em;
            padding-right:0.5em;
            overflow-y:scroll;
        }
        #skip-frame { display:block; height: 30em; }
        div.clear { clear:both; }
        div.control-group { margin-left: 0.5em; vertical-align: bottom; }
        /* div.control-group { height: 3ex; width: 15em; } */
        .help#help_initial { display:block; }
        .help { display:none; }
        /*.help dl { margin-left: 30em; }
        .help ol { margin-left: 30em; }
        .help p { margin-left: 30em; }
        */
        .help h3 { margin-top: 0.25em; }
        .help dd { margin-left: 1em; }
        .help dt { margin-left: 0em; padding: 0.3em; font-weight: bold; }
        .help ol { list-style-position: inside; padding-left: 0em; }
        .help li { margin-left: 0em; margin-bottom: 1ex; }
        .help div.bold { font-weight: bold; display: inline; }
        .help div.entrytext {
           display:inline;
           font-weight:bold;
           font-style:oblique;
        }
        .help div.example:before { content:"Example: "; }

/* fading horizontal rule
  modified from http://konigi.com/tools/css-techniques-horizontal-rules
*/
        .help hr {
  clear: both;
  float: none;
  width: 100%;
  height: 1px;
  margin: 2.4em 0;
  border: none;
  background: #ddd;
  background-image: -webkit-gradient(
      linear,
      left bottom,
      right bottom,
      color-stop(0, rgb(255,255,255)),
      color-stop(0.1, rgb(221,221,221)),
      color-stop(0.9, rgb(221,221,221)),
      color-stop(1, rgb(255,255,255))
  );
  background-image: -moz-linear-gradient(
      left center,
      rgb(255,255,255) 0%,
      rgb(221,221,221) 10%,
      rgb(221,221,221) 90%,
      rgb(255,255,255) 100%
  );
}

        .panel { border-radius:0.6em; border: 2pt solid gray; margin: 0.5em; padding: 0.5em; }
        .panel h3 { margin-top: -1em; margin-bottom: 0.3em; font-size: 1em; }
        .panel h3 .text { background: white; margin-left: 1em; padding: 0 0.3em 0 0.3em; }
        .panel { position: relative; }
        .panel .btn { position:absolute; right: 1em; top: 0.75em;}
        /* .panel .btn { position:absolute; top:1em; right:1em; } */

        /* Keep constant baseline spacing even with superscript/subscript */
        sup, sub {
	  height: 0;
	  line-height: 1;
	  vertical-align: baseline;
	  _vertical-align: bottom;
	  position: relative;
        }
        sup { bottom: 1ex; }
        sub { top: .5ex; }
    </style>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="jquery.tablesorter.min.js"></script>

    <script type="text/javascript">
// IE doesn't seem to support keys
if(!Object.keys) Object.keys = function(o){
 if (o !== Object(o))  throw new TypeError('Object.keys called on non-object');
 var ret=[],p;
 for(p in o) if(Object.prototype.hasOwnProperty.call(o,p)) ret.push(p);
 return ret;
}
        ACTIVE_BUTTON = "activation";
        // Parse environment variables "index.html?cutoff=...&abundance=..."
        function getURLParameter(name) {
            return decodeURIComponent(
                (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
             );
        }
        function format_activation_value(v, cutoff) {
            return (v<cutoff? '---' : v.toExponential(4));
        }
        function nice_number(v) {
            if (Math.abs(Math.round(v)-v) < 0.001) return Math.round(v);
            else return v.toFixed(1);
        }
        function format_mass(v) {
            if (v >= 1000.) return v.toFixed(0)+'&thinsp;g';
            else if (v >= 1.) return v.toFixed(3)+'&thinsp;g';
            else if (v >= 1e-3) return (1e3*v).toFixed(3)+'&thinsp;mg';
            else if (v >= 1e-6) return (1e6*v).toFixed(3)+'&thinsp;ug';
            else if (v >= 1e-9) return (1e9*v).toFixed(3)+'&thinsp;ng';
            else return v.toExponential(4)+'&thinsp;ng';
        }
        function format_time(v) {
            if (v >= 365.2425*24) return nice_number(v/365.2425/24)+' yrs';
            else if (v >= 48 || v == 24) return nice_number(v/24)+' days';
            else if (v >= 2 || v == 1) return nice_number(v)+' hrs';
            else if (v >= 2/60. | v == 1/60.) return nice_number(v*60)+' min';
            else return (v*3600).toPrecision(3)+' sec';
        }
        function parse_half_life(s) {
            var units = {y: 365*24*3600, d: 24*3600, h: 3600, m: 60, s: 1};
            var [value_str, units_str] = s.split(" ");
            return parseFloat(value_str) * units[units_str];
        }
        $.tablesorter.addParser({
            id: 'half-life',
            is: function (s) { return /^ *[0-9.+-eE]+ *[smhdy] *$/.test(s); },
            format: function (s) { return parse_half_life(s); },
            type: 'numeric'
        });
        $.tablesorter.addParser({
            id: 'float',
            is: function (s) { return /^ *[0-9.+-eE]+ *$/.test(s); },
            format: function (s) { return parseFloat(s); },
            type: 'numeric'
        });
        $(document).ready(function() {
            CUTOFF = getURLParameter('cutoff');
            if (CUTOFF==='null') CUTOFF = 0.0001;
            CUTOFF_Bq = CUTOFF*37000;
            DECAY_LEVEL = getURLParameter('decay');
            if (DECAY_LEVEL ==='null') DECAY_LEVEL = CUTOFF>0?CUTOFF:0.0001;
            ABUNDANCE = getURLParameter('abundance');
            if (ABUNDANCE==='null') ABUNDANCE = "IAEA";

            // Enable forms; they are disabled by default so that noscript users
            // can't do anything.
            $('.container').removeClass("disabled");
            $('#id_chemical_formula').removeAttr("disabled");
            $('#id_submit_scat').removeAttr("disabled");
            $('#id_submit_act').removeAttr("disabled");
            $('a').each(function(){ this.tabIndex = -1; });
            $('.help').each(function(){ $(this).append("<hr>"); });
            $('input[type=text]').keydown(function(e) {
                if (e.keyCode == 13) {
                    e.preventDefault();
                    submit_query(ACTIVE_BUTTON);
                }
            });
            $('input[type=text]').focus(function(e) {
                var panel = $(this).closest('.panel')[0].id;
                if (panel == "scattering-panel") {
                    ACTIVE_BUTTON = "scattering";
                } else if (panel == "activation-panel") {
                    ACTIVE_BUTTON = "activation";
                }
            } );

            //$("#id-activationForm").submit(submit_query);
            $("#id-activationForm").submit(function(event) {event.preventDefault();});
            $('#id_submit_scat').click(function() { submit_query('scattering'); });
            $('#id_submit_act').click(function() { submit_query('activation'); });
        });

    function submit_query(target){
        ACTIVE_BUTTON = target;
        $.ajax({
            type:"POST",
            url:"/cgi-bin/nact.py",
            data: {
                calculate: target,
                sample: $('input:text[id=id_chemical_formula]').val(),
                flux: $('input:text[id=id_flux]').val(),
                fast: $('input:text[id=id_fast_ratio]').val(),
                Cd: $('input:text[id=id_Cd_ratio]').val(),
                mass: $('input:text[id=id_mass]').val(),
                density: $('input:text[id=id_density]').val(),
                thickness: $('input:text[id=id_thickness]').val(),
                wavelength: $('input:text[id=id_wavelength]').val(),
                xray: $('input:text[id=id_xray]').val(),
                exposure: $('input:text[id=id_time_on]').val(),
                rest: [0,1,24,360,$('input:text[id=id_time_off]').val()],
                decay: DECAY_LEVEL,
                //abundance: $('input:text[id=id_abundance]').val()
                abundance: ABUNDANCE
            },
            complete: function (xhr, status) {
                //console.log(status);
                if (status==="parsererror") {
                    process_response({'success':false,'detail':{'JSON response':'parse error in return value---maybe NaN or Inf?'}});
                }  else if (status!=="success") {
                    process_response({'success':false,'detail':{'status error':status}});
                }
            },
            //error: function (xhr, status, err) { console.log("error",error); },
            success: process_response
        });
    }

    function cssrule(class_name){
        var ss = document.styleSheets;
        for (var i=0; i<ss.length; i++) {
            var ss = document.styleSheets;
            var rules = ss[i].cssRules || ss[i].rules;
            for (var j=0; j<rules.length; j++) {
                if (rules[j].selectorText === class_name) {
                    return rules[j];
                }
            }
        }
    }
    function show_cutoff(state) {
        if (state) {
            cssrule('div.cutoff').style.display = 'block';
            cssrule('div.nocutoff').style.display = 'none';
        } else {
            cssrule('div.cutoff').style.display = 'none';
            cssrule('div.nocutoff').style.display = 'block';
        }
    }
    function activation_table(act, cutoff) {
        var data = {};
        var content = "";
        //construct headers
        data.headers=["element","reaction","product","half life","0 hrs","1 hr", "24 hrs", "15 days", format_time(act.rest[4])]
        data.rows=[]
        for (var i=0; i < act.activity.length; i++){
            var active = false, row=act.activity[i];
            var columns = [row.isotope, row.reaction, row.product, row.halflife];
            for (var j=0; j < row.levels.length; j++){
                active = active || (row.levels[j] >= cutoff);
                columns.push(row.levels[j])
            }
            if (active) data.rows.push(columns);
        }

        var activity_header, activity_button;
        if (cutoff>0) {
            activity_header = 'Activity above ' + cutoff + ' (&mu;Ci)';
            activity_button = '<button class="activity_button no-print" onClick="show_cutoff(false);">All</button>';
        } else {
            activity_header = 'Activity (&mu;Ci)';
            activity_button = '<button class="activity_button no-print" onClick="show_cutoff(true);">&gt;'+CUTOFF+'&thinsp;&mu;Ci</button>';
        }
        //add headers to table
        content += '<table border=1 class="tablesorter">\n <thead>\n';
        content += '  <tr class="header {sorter:false}"><th colspan="4" /><th colspan="5" class="{sorter:false}">'+activity_header+activity_button+'</th></tr>\n';
        content += '  <tr class="header">';
        for (var i in data.headers) {
            var sorter = (i > 3 ? 'float' : (i == 3 ? 'half-life' : 'text'));
            content += '<th class="headerSortable {sorter: \'' + sorter + '\')">' + data.headers[i] + '</th>';
        }
        content += '</tr>\n </thead>\n <tbody>\n'
        for (var i in data.rows) {
            content += '  <tr id="' + i + '">';
            for (var j=0; j <data.rows[i].length; j++){
                if (j>=4) {
                    content += '<td>'+format_activation_value(data.rows[i][j], cutoff)+'</td>';
                } else {
                    content += '<td>' + data.rows[i][j] + '</td>';
                }
            }
            content += '</tr>\n';
        }
        content += ' </tbody>\n <tfoot>\n  <tr class="header"><th colspan="4">total activity</th>';
        for (var j=0; j < act.total.length; j++) {
            content += '<td>'+format_activation_value(act.total[j], cutoff)+'</td>';
        }
        content += '</tr>\n </tfoot>\n </table>\n';
        return content;
    }
    function process_response(ldata) {
        //console.log(ldata);
        if (typeof(ldata)==="string") ldata=$.parseJSON(ldata);
        if (!ldata.success) {
            var keys = Object.keys(ldata.detail);
            keys.sort();
            var content = '<div class="result error"><hr />\n';
            for (i = keys.length-1; i >= 0; i--) {
                content += '<pre class="error">Error ' +keys[i]+': '+ldata.detail[keys[i]]+'</pre>\n';
            }
            content += '</div>\n';
            $(content).prependTo('div[id=results]');
            return;
        }

        var act = ldata.activation;
        var sample = ldata.sample;
        var scat = ldata.scattering;
        var xscat = ldata.xray_scattering;
        var content = '<div class="result"><hr>\n';

        if (typeof act == 'undefined') {
            // do nothing if not returned
        } else if ("error" in act) {
            // Restricted title
            content += '<p>activation calculation failed with</p><pre>\n'+act.error+'</pre>\n';
        } else {
            // Full title
            content += '<h3>Activation of ' + sample.name + ' after ' + format_time(act.exposure)+' at '+act.flux.toPrecision(3)+' n/cm<sup>2</sup>/s</h3>\n';

            // Disclaimer
            content += '<p class="disclaimer">Estimated activation only. All samples must be evaluated by NIST Health Physics to determine if and how the sample can be removed from the NCNR.</p>';

            // Atoms
            content += '<p>Sample in beam: ' + format_mass(sample.mass) + ' of ' + sample.formula + '\n';

            // Decay time
            if (act.decay_time > 0) {
                content += '<br>Time to decay below '+(1000*act.decay_level).toPrecision(3)+' nCi is '+format_time(act.decay_time)+'.\n';
            }

            // Activation table
            if (CUTOFF == 0.) {
                content += activation_table(act, 0.);
            } else {
                content += '<div class="cutoff">\n' + activation_table(act, CUTOFF) + '</div>\n';
                content += '<div class="nocutoff">\n' + activation_table(act, 0.) + '</div>\n';
            }
        }


        if (typeof scat == 'undefined') {
            // do nothing if not returned
        } else if ("error" in scat) {
            content += '<p>neutron scattering calculation failed with</p><pre>\n'+scat.error+'</pre>\n';
        } else if ("error" in xscat) {
            content += '<p>X-ray scattering calculation failed with</p><pre>\n'+xscat.error+'</pre>\n';
        } else {
            // Drop coherent cross section from penetration depth calculation.
            // An alternative formulation, based on total scattering b, would be
            // penetration = 1/(1/scat.penetration - scat.xs.coh), which perhaps
            // takes diffuse coherent scattering into account [Glinka 2011].
            var penetration = 1 /(scat.xs.abs+scat.xs.incoh);
            var transmission = 100*Math.exp(-sample.thickness/penetration);
            var flux_str = $('input:text[id=id_flux]').val();
            var transmitted_flux = parseFloat(flux_str)*transmission/100.0;

            // Mass density
            var density_str = $('input:text[id=id_density]').val();
            content += "<h3>Scattering from " + sample.name + "</h3>";

            // Source neutrons
            content += "<p>Source neutrons: "
                + scat.neutron.wavelength.toFixed(3) + "&thinsp;&Aring;"
                + " = "+scat.neutron.energy.toFixed(2) + "&thinsp;meV"
                + " = "+scat.neutron.velocity.toFixed(0) + "&thinsp;m/s<br>";
            content += "Source X-rays: "
                + xscat.xray.wavelength.toFixed(3) + "&thinsp;&Aring;"
                + " = " + xscat.xray.energy.toFixed(3) + "&thinsp;keV<br>";
            // Atoms
            content += "Sample in beam: " + sample.formula + " at " + sample.density.toFixed(2) + "&thinsp;g/cm<sup>3</sup>";
            if (density_str.indexOf(':') !== -1) content += " from lattice "+density_str;
            content += "</p>";

            // Neutron scattering
            content += '<table border=1>\n <tr>';
            content += '<th colspan="2">1/e penetration depth<br />(cm)</th>';
            content += '<th colspan="2">Scattering length density<br />(10<sup>-6</sup>/&Aring;<sup>2</sup>)</th>';
            content += '<th colspan="2">Scattering cross section<br />(1/cm)</th>';
            content += '<th colspan="2">X-ray SLD<br />(10<sup>-6</sup>/&Aring;<sup>2</sup>)</th>';
            content += '</tr>\n <tr>';
            content += '<th>abs</th><td>'+(1/scat.xs.abs).toFixed(3)+'</td>';
            content += "<th>real</th><td>"+scat.sld.real.toFixed(3)+'</td>';
            content += '<th>coh</th><td>'+scat.xs.coh.toFixed(3)+'</td>';
            content += "<th>real</th><td>"+xscat.sld.real.toFixed(3)+'</td>';
            content += '</tr>\n <tr>';
            content += '<th>abs+incoh</th><td>'+(1/(scat.xs.incoh+scat.xs.abs)).toFixed(3)+'</td>';
            content += "<th>imag</th><td>"+(-scat.sld.imag).toFixed(3)+'</td>';
            content += '<th>abs</th><td>'+scat.xs.abs.toFixed(3)+'</td>';
            content += "<th>imag</th><td>"+(-xscat.sld.imag).toFixed(3)+'</td>';
            content += '</tr>\n <tr>';
            content += '<th>abs+incoh+coh</th><td>'+scat.penetration.toFixed(3)+'</td>';
            content += '<th>incoh</th><td>'+scat.sld.incoh.toFixed(3)+'</td>';
            content += '<th>incoh</th><td>'+scat.xs.incoh.toFixed(3)+'</td>';
            content += '<th></th><td>'+''+'</td>';
            content += '</tr>\n <tr>';
            content += '</tr>\n</table>';

            // Neutron transmission
            content += '<p>Neutron transmission is '
                    +(transmission>=2||transmitted_flux<CUTOFF_Bq
                      ? transmission.toFixed(2)
                      : transmission.toPrecision(3))
                    +'% for '+sample.thickness+'&thinsp;cm of sample'
                    +' (after absorption and incoherent scattering).\n';
            content += '<br>Transmitted flux is '
                    +transmitted_flux.toPrecision(4)+'&thinsp;n/cm<sup>2</sup>/s'
                    +' for a '+flux_str+'&thinsp;n/cm<sup>2</sup>/s beam.</p>\n';
        }


        // End of div
        content += '</div>\n';

        $(content).prependTo('div[id=results]'); //add to the dom
        $("table").tablesorter({sortList: [[8,1]]});
    }
    </script>

    <!--<script type="text/javascript" src="/static/lib/activation.js"></script>-->


</head>
<body>

<?php
  include("/var/www/include/navigation.inc");
  include("/var/www/include/utility.inc");
?>

<noscript>
<h3>Enable javascript to run the activation calculator.</h3><hr />
</noscript>

<div class="container disabled">

    <div id="activation-frame" class="no-print">

        <form id="id-activationForm" class="blueForms" method="post">

            <div class="panel" id="material-panel">
            <h3><span class="text">Material</span></h3>
            <table><tbody>
            <tr>
              <td>
               <div class="controls"><input id="id_chemical_formula" type="text" class="textinput textInput" name="chemical_formula" value="Co" title="chemical formula for the material or mixture" ></div>
              </td>
            </tr></tbody></table>
            </div>

            <div class="panel" id="activation-panel">
            <h3><span class="text">Neutron Activation</span></h3>
            <table><tbody><tr>
              <td rowspan="2" valign="bottom">
               <label for="id_flux" class="control-label requiredField">Thermal flux</label>
              </td>
              <td colspan="2" align="center">For rabbit system</td>
            </tr>

            <tr>
              <td>
               <label for="id_Cd_ratio" class="control-label">Cd ratio</label>
              </td>
              <td>
               <label for="id_fast_ratio" class="control-label">Thermal/fast ratio</label>
              </td>
            </tr>


            <tr>
              <td>
               <div class="controls"><input id="id_flux" type="text" class="textinput textInput" name="flux" value="1e8" title="Thermal beam flux at sample"> </div>
              </td>
              <td>
               <div class="controls"><input id="id_Cd_ratio" type="text" class="textinput textInput" name="Cd_ratio" value="0" title="Cd ratio, or 0 if no epithermal neutrons."> </div>
              </td>
              <td>
               <div class="controls"><input id="id_fast_ratio" type="text" class="textinput textInput" name="fast_ratio" value="0" title="Thermal/fast neutron ratio, or 0 if no fast neutrons."> </div>
              </td>
            </tr>

            <tr>
              <td>
               <label for="id_mass" class="control-label">Mass</label>
              </td><td>
               <label for="id_time_on" class="control-label">Time on beam</label>
              </td><td>
               <label for="id_time_off" class="control-label">Time off beam</label>
              </td>
            </tr>

            <tr>

              <td>
               <div class="controls"><input id="id_mass" type="text" class="textinput textInput" name="mass" value="" title="Sample mass.  Activation scales linearly with mass."></div>
              </td><td>
               <div class="controls"><input id="id_time_on" type="text" class="textinput textInput" name="time_on" value="10" title="Sample exposure time in hours, minutes, seconds, days, weeks or years."> </div>
              </td><td>
               <div class="controls"><input id="id_time_off" type="text" class="textinput textInput" name="time_off" value="1 y" title="Time since sample was removed from the beam.  0, 1 hour, 1 day and 15 days are automatically calculated"> </div>
              </td>
            </tr></tbody></table>
            <input type="submit" name="submit_act" value="Calculate" class="btn btn-primary" id="id_submit_act">
            </div>

            <div class="panel" id="scattering-panel">
            <h3><span class="text">Absorption and Scattering</span></h3>
            <table><tbody><tr>
              <td>
               <label for="id_density" class="control-label">Density</label>
              </td><td>
               <label for="id_thickness" class="control-label">Thickness</label>
              </td>
            </tr><tr>
              <td>
               <div class="controls"><input id="id_density" type="text" class="textinput textInput" name="density" value="" title="Mass density as val or a:val b:val c:val (Å) alpha:val beta:val gamma:val (°)."></div>
              </td><td>
               <div class="controls"><input id="id_thickness" type="text" class="textinput textInput" name="thickness" value="1" title="Sample thickness for computing total scattering."></div>
              </td>
            </tr><tr>
              <td>
               <label for="id_wavelength" class="control-label">Source neutrons</label>
              </td><td>
               <label for="id_xray" class="control-label">Source X-rays</label>
              </td>
            </tr><tr>
              <td>
               <div class="controls"><input id="id_wavelength" type="text" class="textinput textInput" name="wavelength" value="1 Ang" title="Neutron source."></div>
              </td><td>
               <div class="controls"><input id="id_xray" type="text" class="textinput textInput" name="xray" value="Cu Ka" title="X-ray source."></div>
              </td>
            </tr></tbody></table>
            <input type="submit" name="submit_scat" value="Calculate" class="btn btn-primary" id="id_submit_scat">
            </div>
<!--
            <div id="div_id_abundance" class="control-group">
               <label for="id_abundance" class="control-label requiredField">Abundance (IAEA or NIST)</label>
               <div class="controls"><input id="id_abundance" type="text" class="textinput textInput" name="abundance" value="NIST"
                    title="Isotopic abundance for activation calculation uses either IAEA Report 273: Handbook of Nuclear Activation Data, 1987, or NIST Isotopic Composition of the Elements, 2001; sld and absorption calculations use NIST abundance."
               /> </div>
            </div>
-->
        </form>

    </div>
    <div id="help-frame" class="no-print">
<div id="help_initial" class="help">
<h3>Neutron activation and scattering calculator</h3>
<p>
This calculator uses neutron cross sections to compute activation
on the sample given the mass in the sample and the time in the beam,
or to preform scattering calculations for the neutrons which are
not absorbed by the sample.
</p>
<ol>
<li>Enter the sample formula in the material panel.</li>
<li>To perform activation calculations, fill in the thermal
flux, the mass, the time on and off the beam, then press the
calculate button in the neutron activation panel.</li>
<li>To perform scattering calculations, fill in the wavelength
of the neutron and/or xrays, the thickness and the
density (if not given in the formula), then press the
calculate button in the absorption and scattering panel.</li>
</ol>
</div>

<!-- help for individual fields -->
<div id="help_chemical_formula" class="help">
<h3>Chemical formula</h3>
<p>The chemical formula parser allows you to specify materials and mixtures.
Formulas are parsed with
<a href="http://reflectometry.org/danse/docs/elements/guide/formula_grammar.html">periodictable</a>
python package.
</p>

<dl>
<dt>simple formula</dt>
<dd>A basic formula consists of elements and their quantities.
<div class="example"><div class="entrytext">CaCO3</div> represents the chemical CaCO<sub>3</sub></div>
</dd>

<dt>multi-part formula</dt>
<dd>Formulas can be built from parts by separating them with "+" or space,
    with a number before the part representing repeats.  Using parentheses,
    a formula is treated as if it were a single unit.
    <div class="example"><div class="entrytext">CaCO3+6H20</div>,
    <div class="entrytext">CaCO3 6H2O</div> and
    <div class="entrytext">CaCO3(H2O)6</div> all represent ikaite,
        CaCO<sub>3</sub>&middot;6H<sub>2</sub>O
    </div>
</dd>

<dt>isotopes</dt>
<dd>Isotopes are represented by element[nuclide index].
Special symbols <div class="entrytext">D</div> and
<div class="entrytext">T</div>
can be used for <sup>2</sup>H and <sup>3</sup>H.
Isotopes can be mixed within a formula, such as
<div class="entrytext">DHO</div> for partially deuterated water.
<div class="example"><div class="entrytext">O[18]</div> represents the <sup>18</sup>O</div>
</dd>

<dt>density</dt>
<dd>Mass density is needed to compute scattering factors for the material.
The density can be entered in the density field, or it can be given in
the formula by adding @value to the end.  Densities for the pure elements are
already known.
<div class="example"><div class="entrytext">H2O@1</div>
indicates that water has a density of 1 g/cm<sup>3</sup></div>
</dd>

<dt>isotopic density</dt>
<dd>If the formula uses a mixture of isotopes, you can still use the density
of the material assuming natural abundance, but add an "n" to the value
to scale it to the isotope specific density.  If you already know the
isotopic density, use the value by itself and it will not be scaled.
<div class="example"><div class="entrytext">D2O@1n</div>,
<div class="entrytext">D2O@1.11</div>, and
<div class="entrytext">D2O@1.11i</div>
all give the density of D<sub>2</sub>O as 1.11 g/cm<sup>3</sup></div>
</dd>

<dt>mole fractions</dt>
<dd>Using non-integer quantities, arbitrary concentration ratios can be
    be constructed.
    <div class="example"><div class="entrytext">78.2H2O[16] + 21.8H2O[18] @1n</div>
        represents water with 78.2% <sup>16</sup>O and 21.8% <sup>18</sup>O
    </div>
</dd>

<dt>mass fractions</dt>
<dd>Formulas can be mixed by mass, with each part starting with a percentage
    followed by formula followed by "//".  The first part must use "%wt" to
    indicate that it is a mass fraction.  The final part is the base, and it
    does not need a percentage since it makes up the rest of the material.
    <div class="example"><div class="entrytext">50%wt Co // Ti</div>
    is more descriptive than Co<sub>0.552</sub>Ti<sub>0.448</sub></div>
    <div class="example"><div class="entrytext">33%wt Co // 33% Fe // Ti</div>
    builds a 1:1:1 mixture by mass of cobalt-iron-titanium</div>
</dd>

<dt>volume fractions</dt>
<dd>Volume fractions are like mass fractions, but they use "%vol" instead.
    Each component of the volume fraction must specify the density.
    <div class="example"><div class="entrytext">20%vol (10%wt NaCl@2.16 // H2O@1) // D2O@1n</div>
        is a 10% saline solution by weight mixed 20:80 by volume with
        D<sub>2</sub>O, which is the same as
        <div class="entrytext">NaCl(H2O)29.1966(D2O)122.794@1.10i</div>
    </div>
</dd>

<dt>mass and volume mixtures</dt>
<dd>Specific amounts of materials can be mixed, with each part giving
    the quantity of material followed by "//".  Quantities can be masses
    (kg, g, mg, ug, or ng) or they can be volumes (L, mL, uL, nL).  Density
    is required for materials given by volume.  For scattering calculations
    density is required for the materials given by mass as well.
    <div class="example"><div class="entrytext">5g NaCl // 50mL H2O@1</div>
        is more descriptive than
        <div class="entrytext">NaCl(H2O)32.4407</div>
    </div>
    <div class="example"><div class="entrytext">5g NaCl@2.16 // 50mL H2O@1</div>
        computes the density as 1.05 g/cm<sup>3</sup>.  Not useful in this
        case since 9%wt brine has a density of 1.0633 at ambient temperature.
    </div>
    <div class="example"><div class="entrytext">50 mL (45 mL H2O@1 // 5 g NaCl)@1.0707 // 20 mL D2O@1n</div>
        uses the appropriate density for a 10%wt brine in the mixture.
</dd>

<dt>layer thickness</dt>
<dd>Multilayer samples can specified as layer thickness and material separated
    by "//".  Thicknesses are in length units (cm, mm, um, nm).  The
    resulting material will compute activation for 1 cm<sup>2</sup> of material.
    Density is required for each layer.
    <div class="example"><div class="entrytext">1 cm Si // 5 nm Cr // 10 nm Au</div>
</dd>
</dl>
</div>

<div id="help_mass" class="help">
<h3>Material mass</h3>
<p>Units: g, kg, mg or ug</p>
<p>
The total neutron activation depends on the mass of the individual
isotopes in the sample and the total time in the beam.  All activation
calculations assume a thin plate sample, with all parts of the sample
exposed to full flux during activation, and no self-shielding when
estimating the activation level outside the beam.
</p>
<p>Neutron activation is a function of isotope, not element.  When
an element is used in a formula, the natural abundance of the individual
isotopes is used to determine the total activation.  By default, the
activation calculator uses values from the IAEA handbook<sup>1</sup>, and the
scattering calculator uses the NIST atomic weights and isotope composition
	database.<sup>2</sup>
</p>

<p>Parameters are controlled by URL:
<dl>
<dt>isotope abundance</dt>
<dd>
The NIST database can be selected for isotope abundance using:
<a href="index.html?abundance=NIST">index.html?abundance=NIST</a>
</dd>

<dt>activation cutoff</dt>
<dd>
The cutoff values for displaying activation data are set to 0.0001&thinsp;&mu;Ci
by default.  The full activation levels
can be displayed using: <a href="index.html?cutoff=0">index.html?cutoff=0</a>
</dd>

<dt>decay cutoff</dt>
<dd>The activation calculator determines the amount of time for the activation to decay to
the cutoff level, or to 0.0001&thinsp;&mu;Ci if cutoff is 0.  This can be set to a value
such as 0.1&thinsp;&mu;Ci using: <a href="index.html?decay=0.1">index.html?decay=0.1</a>
</dd>
</dl>
</p>

<ol>
<li><em>IAEA (1987) Handbook on Nuclear Activation Data. TR 273 (International Atomic Energy Agency, Vienna, Austria, 1987).</em>
<a href="http://cds.cern.ch/record/111089/files/IAEA-TR-273.pdf">http://cds.cern.ch/record/111089/files/IAEA-TR-273.pdf</a>
</li>
<li><em>Bölke, et al. Isotopic Compositions of the Elements, 2001. J. Phys. Chem. Ref. Data, Vol. 34, No. 1, 2005</em>
<a href="http://www.nist.gov/pml/data/comp.cfm">http://www.nist.gov/pml/data/comp.cfm</a>
</li>
</ol>
</div>

<div id="help_density" class="help">

<h3>Mass density</h3>
<p>Units: g/cm<sup>3</sup> or A3
<p>
Density is used to compute absorption, transmission and scattering.
<dl>
<dt>default from formula</dt>
<dd>Leave the density field blank and add <div class="entrytext">@</div> plus
the density to the end of the formula, where density is in
g/cm<sup>3</sup>.  For compounds with specific isotopes, you can use the
density of the naturally occurring compound as <div class="entrytext">@</div>
plus density plus <div class="entrytext">n</div> and the isotope specific
density will be computed.  Density defaults to 1 g/cm<sup>3</sup>, or for
pure elements, the natural density given in the periodic table is used.

<div class="example"><div class="entrytext">D2O@1n</div> or
<div class="entrytext">D2O@1.11</div></div>
</dd>
<dt>g/cm<sup>3</sup></dt>
<dd>Enter the density by itself, which will be interpreted as g/cm<sup>3</sup>, or
equivalently, kg/L.  No units are needed.  If the value ends with an 'i',
then the density used will be the isotopic density, otherwise the natural
density will be used, and the material density will be computed by
substituting the isotope ratios given in the formula.
<div class="example">D<sub>2</sub>O has a natural density of
<div class="entrytext">1n</div> and an isotopic density of
<div class="entrytext">1.11</div></div>
</dd>
<dt>cell volume</dt>
<dd>Enter a number followed by A3 for &Aring;<sup>3</sup>.  Be sure that your
formula contains the correct number of atoms for the unit cell, possibly by
using n(formula), where n is 6 for hexagonal close packed, 4 for face centered
cells, 2 for body centered and base centered cells, or 1 for simple cells.
<div class="example">4NaCl has a cell volume of
<div class="entrytext">179.4 A3</div></div>
</dd>
<dt>crystal lattice parameters</dt>
<dd>Enter lattice parameters "a:n b:n c:n alpha:n beta:n gamma:n"
where a, b, c are in &Aring; and &alpha;, &beta;, &gamma; are in degrees.
If not specified, b and c default to a.  Ratios can also be used,
so that "b/a:n" gives b=n*a, and "c/a:n" gives c=n*a.  Angles
&alpha;, &beta;, and &gamma; default to 90&deg;.  Be sure that the
formula contains the correct number of atoms for the unit cell.
<div class="example">4NaCl has a lattice of
<div class="entrytext">a:5.6402</div></div>
</dd>
</dl>
</div>

<div id="help_thickness" class="help">
<h3>Thickness</h3>
<p>Units: cm</p>
<p>
The material thickness in cm is used to determine sample transmission,
or how much beam will be absorbed by the sample or scattered incoherently.
Leave it at 1 cm if you do not need this information.
</p>
</div>

<div id="help_flux" class="help">
<h3>Thermal flux</h3>
<p>Units: n/cm<sup>2</sup>/s</p>
<p>
Provide the thermal flux equivalent for the pre-sample beam configuration
for the instrument.  This is only need for computing the neutron activation<sup>1</sup>
from the experiment, and is not used for computing scattering cross
sections.
</p><p>
Within the NCNR, you can access a list of
<a href="http://www-i.ncnr.nist.gov/beamline_operations/instrument_fluxes.html">instrument fluxes</a>,
but this is not available from outside.
</p>
<ol>
<li><em>IAEA (1987) Handbook on Nuclear Activation Data. TR 273 (International Atomic Energy Agency, Vienna, Austria, 1987).</em>
<a href="http://cds.cern.ch/record/111089/files/IAEA-TR-273.pdf">http://cds.cern.ch/record/111089/files/IAEA-TR-273.pdf</a>
</li>
</ol>
</div>

<div id=help_Cd_ratio class="help">
<h3>Cadmium ratio</h3>
<p>Units: none</p>
<p>
Samples in the rabbit tubes can be shielded with cadmium to reduce the thermal
flux while leaving the epithermal flux mostly unchanged.  The cadmium ratio
determines the degree of reduction in the scattering cross sections, corresponding
to the reduced flux.  This value is unitless.  Use a value of 0 for beamline
experiments.
</p>
</div>

<div id=help_fast_ratio class="help">
<h3>Thermal/fast ratio</h3>
<p>Units: none</p>
<p>
When performing neutron activation analysis in a rabbit tube, the additional
fast neutron activations need to be determined.  The thermal/fast ratio is
used to determine the fast neutron flux from the thermal flux equivalent for
the given rabbit tube.  The resulting fast flux is (thermal flux)/(thermal/fast ratio).
This value is unitless.  Use a value of 0 for beamline experiments.
</p>
</div>

<div id=help_time_on class="help">
<h3>Time on beam</h3>
<p>Units: h m s d w y
<p>
Time on the beam is the length of the exposure at the given flux.  Activation
will be accumulated over time.
Time defaults to hours, but can be set to
hours, minutes, seconds, days, weeks or years by adding h, m, s, d, w, or y
to the value respectively.
</p>
</div>

<div id=help_time_off class="help">
<h3>Time off beam</h3>
<p>Units: h m s d w y OR yyyy-mm-dd hh:mm:ss
<p>
The sample begins to decay immediately, even while it is being activated.
The time off beam field allows you to specify how long since the sample
was removed from the beam.  The default is hours, but can be set to
hours, minutes, seconds, days, weeks or years by adding h, m, s, d, w, or y
to the value respectively.
We always compute the activation level when the sample is removed from the beam,
and at 1 hour, 1 day and 15 days post activation.
</p>
<p>
Instead of saying how long ago the sample was removed from the beam, you can
specify when it was removed.  Times are given as
    year-month-day hour:minute:second.
Approximate times are allowed, such as 2010-03 for March, 2010.  This is
equivalent to 2010-03-31 23:59:59, which is the end of March so that the
activation estimate will be conservative.  That is, this is the most activation
consistent with the sample being on the beam sometime in March, 2010.
Times are specified in US/Eastern.  Add "Z" after the time of day to
indicate universal coordinated time (UTC), or add a timezone offset such
as "+01" for +1 hours in France in winter, when daylight savings time is
not in effect.
</p>
<h4>Examples</h4>
<table>
<tr><th>If you type:</th><th>This is equivalent to:</th></tr>
<tr><td>2 m</td><td>2 minutes ago</td></tr>
<tr><td>1</td><td>1 hour ago</td></tr>
<tr><td>2.5w</td><td>2 and a half weeks ago</td></tr>
<tr><td>3 y</td><td>3 years ago</td></tr>
<tr><td>2015-01-02 21:45:00</td><td>January 2, 2015 at 9:45 PM US/Eastern</td></tr>
<tr><td>2010-03</td><td>March 31, 2010 at 11:59:59 PM US/Eastern</td></tr>
<tr><td>2010-7-5 12:23</td><td>July 5, 2010 at 12:23:59 PM US/Eastern</td></tr>
<tr><td>2015-01-02 21:45:00Z</td><td>January 2, 2015 at 9:45 PM UTC</td></tr>
<tr><td>2015-01-02 21:45:00-0600</td><td>January 2, 2015 at 9:45 PM US/Central</td></tr>
<tr><td>2015-08-02 21:45:00-0500</td><td>August 2, 2015 at 9:45 PM US/Central</td></tr>
<tr><td></td><td></td></tr>
</table>

</div>

<div id=help_wavelength class="help">
<h3>Source neutrons</h3>
<p>Units: Ang, meV or m/s</p>
<p>
The energy of the source neutrons will affect the absorption cross section
and hence the penetration depth and sample attenuation.  Energy can be
expressed as wavelength in &Aring;, as energy in meV, or as neutron
velocity in m/s.
</p><p>
Neutron cross sections are
<a href="http://www.ati.ac.at/~neutropt/scattering/Scattering_lengths_table_20010419.pdf">tabulated</a><sup>1</sup>
at 1.798&nbsp;&Aring; = 25.3 meV = 2200 m/s, with an assumed 1/v dependence for
the absorption cross section.  For heavier
isotopes (Cd, Hf, rare earths) and/or shorter wavelengths (below 1&nbsp;&Aring;)
there are neutron <a href="resonance.html">resonances</a> which are not
accounted for in the scattering calculator.  There is also a 1/v dependence for
single phonon interactions which gives rise to significant inelastic scattering
for lighter isotopes (H, D) and/or longer wavelengths (above 5&nbsp;&Aring;).
This factor is both temperature and material dependent and will not be included
in the scattering calculations.
</p>
<ol>
<li><em>Rauch, H. and Waschkowski, W. (2003) Neutron Scattering Lengths in ILL Neutron Data Booklet (second edition), A.-J. Dianoux, G. Lander, Eds. Old City Publishing, Philidelphia, PA. pp 1.1-1 to 1.1-17.</em>
</ol>
</div>

<div id=help_xray class="help">
<h3>Source X-rays</h3>
<p>Units: Ang, keV or Ka</p>
<p>
X-ray absorption and scattering are computed from the energy dependent
atomic scattering factors.<sup>1</sup>
Energy can be expressed as wavelength in &Aring;, as energy in keV, or
using an element name for the K<sub>&alpha;</sub> emission line<sup>2</sup> for
that element.
</p>

<ol>
<li><em>B.L. Henke, E.M. Gullikson, and J.C. Davis. X-ray interactions:
photoabsorption, scattering, transmission, and reflection at E=50-30000 eV, Z=1-92,
Atomic Data and Nuclear Data Tables Vol. 54 (no.2), 181-342 (July 1993).</em>
<a href="http://henke.lbl.gov/optical_constants/">http://henke.lbl.gov/optical_constants/</a>
</li>
<li><em>R. D. Deslattes, E. G. Kessler, Jr., P. Indelicato, L. de Billy,
       E. Lindroth, and J. Anton.  Rev. Mod. Phys. 75, 35-99 (2003).</em>
<a href="http://www.nist.gov/pml/data/xraytrans/index.cfm">http://www.nist.gov/pml/data/xraytrans/index.cfm</a>
</li>
</div>

<!-- end of help -->

    </div>
    <div class="clear" />
</div>

    <div id="skip-frame" class="no-print">&nbsp;</div>
    <h3 class="print-only">Activation and Scattering Results</h3>
    <div id="results" />

</div>
<hr>
<div class="footer">
  <div style="float:left;"><p>
<em>Questions?</em><br>
Neutron activation: Dave Brown &lt;<a href="mailto:david.brown@nist.gov">david.brown@nist.gov</a>&gt;<br>
Scattering calculations: Paul Kienzle &lt;<a href="mailto:paul.kienzle@nist.gov">paul.kienzle@nist.gov</a>&gt;
</p></div>
  <div style="float:right;"><p><?php lastmod(); ?></p></div>
</div>

<script type="text/javascript">
//$('input').focusin(function(){ $("#help_"+this.id.slice(3)).show();});
//$('input').focusout(function(){$("#help_"+this.id.slice(3)).hide();});
// Display help on input
ACTIVE_HELP=$("#help_initial");
$('input').focusin(function(){
  if (ACTIVE_HELP) ACTIVE_HELP.hide();
  ACTIVE_HELP = $("#help_"+this.id.slice(3));
  if ($(ACTIVE_HELP).length == 0) ACTIVE_HELP = $("#help_initial");
  ACTIVE_HELP.show();
});
$('#help-frame').height($('#activation-frame').height());
$('#skip-frame').height($('#activation-frame').height());
</script>
